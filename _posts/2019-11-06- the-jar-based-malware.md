---
layout: post
title:  "Pyrogenic – The JAR -Based Malware Spreading Across Africa and the Middle East ."
author: Rotimi
categories: [ Malware, Hacking ]
tags: [rotimi, naijasecforce, malware]
image: ../assets/images/shell_lunchbox_1.jpg
description: "Malware discovered."
featured: true
hidden: true
rating: 4.5
---

## Time Frame
3rd November, 2019 - Current

## Overview
The NaijaSecForce team have detected a new wave of malware spreading across Africa and the Middle East. This malware comes in form of a spam campaign targeting corporate mailboxes within Africa and the Middle east.
We started receiving reports of this malware campaign on the 3rd of November. The pyrogenic malware started initial propagation in August 2019 – but then, it went quiet till November 2019 when we noticed a massive spike

## Technical Description

At first glance, it looks to be a simple, harmless email with a supposed attachment. However, on closer look, what looks like an attachment, is an image with a hyperlink.

![](../assets/images/Malware-email-recieved.png)

The hyperlink is https[:]//bandirmaad[.]com/RA.html and it redirects to cevrimiciciftci[.]com/Remittance_pdf.jar where a file gets downloaded to the victim’s PC.

![](../assets/images/Malware-file.png)

This malware relies on the victim to open the .jar file. The malicious .jar file is portrayed as a “Supplier Remittance” pdf file, which is a fairly typical lure used in malware campaigns.
Upon launching the malicious file “Remittance_pdf.jar”, we noticed an outbound connection to the CnC server 157.245.160.150 on port 80.

[](../assets/images/Malware-CnC.png)

Shortly after, two DLL files get dropped and loaded,it creates a file path ImageLoaded: C:\Users\Naijasecforce\AppData\Local\Temp\sqlite-3.8.11.2-2dd62d12-e663-4673-99f4-086ae2f51227-sqlitejdbc.dll

[](../assets/images/malware-dll1.png)

ImageLoaded: C:\Users\Naijasecforce\AppData\Local\Temp\jna-874362087\jna1710670949295234061.dll

CMD.exe Launches for Command execution.
We noticed cmd.exe automatically launches spawning off a powershell command
 [](../assets/images/malware-powershell.png)

CommandLine: cmd.exe /c chcp 1252 > NUL & powershell.exe -ExecutionPolicy Bypass -NoExit -NoProfile -Command -

The Trojan then connects to the following remote location to gather the external IP address of the compromised computer:

[](../assets/images/malware-connect.png)

Current Detection
We ran this malware against Virustotal and only 1/59 detections.

[](../assets/images/malware-detection.jpg)


S/N | Description| Detailed Information
--- | --- | ---
1 | Malware Hosting sites (links in email) | hxxps://cevrimiciciftci.com/Remittance_pdf.jar
                                             hxxp://bandirmaad.com/RA.html




